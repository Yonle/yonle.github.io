<!DOCTYPE html>
<html>
<head>
  <title>Yonle</title>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="My personal site.">
</head>
<body>
<div id="__addressbar">
  <input id="__urlbox" placeholder="Type address...." value="/public/index.hr"></input>
  <button onclick="visit()" type="submit">Go!</button>
</div>
<br>
<div id="__view"><p id="nojs">It seems like you disabled Javascript. Because of that, This site won't work anymore.</p></div>
<span id="__mesg"></span>
<button id="__darkmode" onclick="darkmode()">Dark Mode</button>
</body>
<style>
#__mesg {
	position: fixed;
	bottom: 4px;
	left: 4px;
	display: block;
	border: solid;
	border-radius: 3px;
	color: red;
	background: white;
	z-index: 3;
}

button {
	border: solid;
	border-radius: 3px;
	color: black;
	background: white;
}

#__darkmode {
	position: fixed;
	bottom: 4px;
	right: 4px;
}

#__addressbar {
	position: fixed;
	z-index: 2;
	top: 0;
	left: 0;
	width: auto;
	height: auto;
	border: solid;
}


</style>
<script>
document.getElementById("nojs").style.display = "none";
</script>
<script src="index.js"></script>
<script>
	const viewelem = document.getElementById("__view"); // View Elememt
	const mesgelem = document.getElementById("__mesg"); // Error message element.
	const dmelem = document.getElementById("__darkmode");
	let dm = false;
	if (typeof hender !== "function") {
		document.write("hender() is not a function, Or a component is failed to load in your browser. Please try again later or refresh the page. If the problem still persist, Check your network connection and browser update, or contact to the website owner.");
		throw new Error("hender() is not a function!");
	}

	const render = hender();

	function msg(m, e) {
		if (mesgelem.timeout) clearTimeout(mesgelem.timeout);
		mesgelem.style.display = "block";
		mesgelem.innerHTML = m;
		mesgelem.style.color = e ? "red" : (dm ? "white" : "black");
		mesgelem.timeout = setTimeout(() => {
		mesgelem.style.display = "none";
		}, 5000);
	}

	// Function to go & load....
	async function goTo(url) {
		let startDate = Date.now();
		msg("Loading " + url + "....");
		try {
			let res = await fetch(url);
			if (!res.ok) throw "Server responded with " + res.status;
			msg("Server responded. Waiting for reply....");
			let body = await res.text();;
			viewelem.innerHTML = render(body);
			msg("Loaded in " + ((Date.now() - startDate) / 100).toFixed(2) + "s");
		} catch (err) {
			msg("Something Went Wrong!<br>" + err.toString(), 1);
		}
	}

	function darkmode() {
		if (dm) {
			document.body.style.color = "black";
			document.body.style.background = "white";
			dmelem.innerHTML = "Dark Mode";
			dmelem.style.background = "white";
			dmelem.style.color = "black";
			mesgelem.style.background = "white";
			dm = false;
		} else {
			document.body.style.color = "white";
			document.body.style.background = "black";
			dmelem.innerHTML = "Light Mode";
			dmelem.style.background = "black";
			dmelem.style.color = "white";
			mesgelem.style.background = "black";
			dm = true;
		}
	}

	function visit() {
		let abox = document.getElementById("__urlbox");
		goTo(abox.value);
	}

	// Load main page
	goTo("/public/index.hr");
</script>
</html>
